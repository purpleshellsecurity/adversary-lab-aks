# ============================================================================
# Attacker Namespace Network Policies
# Permissive — allows offensive tool traffic while maintaining logging
# ============================================================================

---
# Allow all egress from attacker namespace
# Red team tools need to reach victim services, external repos, metadata API
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-all-egress
  namespace: attacker
  labels:
    adversary-lab/policy-type: "permissive"
  annotations:
    adversary-lab/mitre: "Enables T1046 (Network Service Discovery), T1550.001 (Lateral Movement)"
spec:
  podSelector: {}
  policyTypes:
    - Egress
  egress:
    - {} # Allow all outbound

---
# Deny ingress from victim namespace (prevent reverse shells from victim → attacker)
# This creates a more realistic scenario where the attacker must initiate
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: deny-victim-ingress
  namespace: attacker
spec:
  podSelector: {}
  policyTypes:
    - Ingress
  ingress:
    - from:
        - namespaceSelector:
            matchExpressions:
              - key: adversary-lab/role
                operator: NotIn
                values:
                  - "target"
